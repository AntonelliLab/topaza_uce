plot(newmap,asp=1)
points(lon, lat, col = "red", cex = 1 ,pch = 21)
png('~/Desktop/fossil_occurrences_world.png',width = 5000, height = 5000)
plot(newmap,asp=1)
points(lon, lat, col = "red", cex = 1 ,pch = 21)
dev.off()
png('~/Desktop/fossil_occurrences_world.png',width = 5000, height = 5000)
plot(newmap,asp=1)
points(lon, lat, col = "red", cex = 1 ,pch = 19)
dev.off()
plot(newmap,asp=1)
points(lon, lat, col = "red", cex = 1 ,pch = 19)
dev.off()
png('~/Desktop/fossil_occurrences_world.png',width = 3000, height = 3000)
plot(newmap,asp=1)
points(lon, lat, col = "red", cex = 2 ,pch = 19)
dev.off()
png('~/Desktop/fossil_occurrences_north_america.png',width = 3000, height = 3000)
plot(newmap, xlim=c(-125,-45), ylim=c(40,40), asp=1)
points(lon, lat, col = "red", cex = 2 ,pch = 19)
dev.off()
?make_option
??make_option
if(!require(optparse)){install.packages("optparse",repos = "http://cran.us.r-project.org")}
if(!require(tidyverse)){install.packages("tidyverse",repos = "http://cran.us.r-project.org")}
inp <- list.files('/Users/tobias/Desktop/secapr_ms/data/processed/cleaned_trimmed_reads/fastqc_results/', pattern = ".zip")
inp
opt$input_folder = '/Users/tobias/Desktop/secapr_ms/data/processed/cleaned_trimmed_reads/fastqc_results/'
opt <- ''
opt$input_folder = '/Users/tobias/Desktop/secapr_ms/data/processed/cleaned_trimmed_reads/fastqc_results/'
opt
inp <- list.files(opt$input_folder, pattern = ".zip")
opt$output_file = '/Users/tobias/Desktop/secapr_ms/data/processed/cleaned_trimmed_reads/fastqc_overview.pdf'
fastqc_results <- lapply(inp, function(k){
unzip(paste(opt$input_folder, k, sep = "/"))
inpu <- read_delim(paste(paste(gsub(".zip", "", k)),
"summary.txt", sep = "/"), delim = "\t")
out <- as_data_frame(t(inpu[, 1])) %>%
mutate(sample.id = names(inpu)[3])
names(out) <- c(gsub(" ", "_", unlist(inpu[,2])), "sample_id")
unlink(x = paste(opt$input_folder, gsub(".zip", "", k), sep = "/"),
recursive = T, force = T)
return(out)
})
outp <- do.call("rbind.data.frame", fastqc_results)%>%
select(ID = sample_id,
PBQ = Per_base_sequence_quality,
PTQ = Per_tile_sequence_quality,
PSQ = Per_sequence_quality_scores,
PBC = Per_base_sequence_content,
SGC = Per_sequence_GC_content,
PBN = Per_base_N_content,
SLD = Sequence_Length_Distribution,
SDL = Sequence_Duplication_Levels,
ORS = Overrepresented_sequences,
AdC = Adapter_Content,
KmC = Kmer_Content)
#change table format
ret <- outp %>%
group_by(ID) %>%
gather(test, status, PBQ:KmC)
#plot how many samples failed the test
qc.fail <- ggplot()+
geom_bar(data = ret, aes(x = test, fill = status), stat = 'count', position = 'dodge')+
theme_bw()
#plot which sample failed which test
qc.samples <- ggplot()+
geom_tile(data = ret, aes(y = ID, x = test, fill = as.factor(status)))+
scale_fill_discrete(name = "Test\nstatus")+
xlab("FastQC test")+
ylab("Samples")+
theme_bw()+
theme(
axis.text.y = element_blank()
)
#plot pdf
pdf(opt$output_file)
print(qc.fail)
print(qc.samples)
dev.off()
#table with samples that faild a test
fail <- ret %>%
filter(status == "FAIL")
#get the ID number of the failed samples
fail.samp <- fail %>%
filter(!duplicated(ID)) %>%
select(ID)%>%
unlist() %>%
parse_number()%>%
unique() %>%
sort()
if(opt$print){
write(sprintf("The following sample failed at least one test: %s \n", fail.samp), stdout())
}
inp <- list.files(opt$input_folder, pattern = ".zip")
fastqc_results <- lapply(inp, function(k){
unzip(paste(opt$input_folder, k, sep = "/"))
inpu <- read_delim(paste(paste(gsub(".zip", "", k)),
"summary.txt", sep = "/"), delim = "\t")
out <- as_data_frame(t(inpu[, 1])) %>%
mutate(sample.id = names(inpu)[3])
names(out) <- c(gsub(" ", "_", unlist(inpu[,2])), "sample_id")
unlink(x = paste(opt$input_folder, gsub(".zip", "", k), sep = "/"),
recursive = T, force = T)
return(out)
})
outp <- do.call("rbind.data.frame", fastqc_results)%>%
select(ID = sample_id,
PBQ = Per_base_sequence_quality,
PTQ = Per_tile_sequence_quality,
PSQ = Per_sequence_quality_scores,
PBC = Per_base_sequence_content,
SGC = Per_sequence_GC_content,
PBN = Per_base_N_content,
SLD = Sequence_Length_Distribution,
SDL = Sequence_Duplication_Levels,
ORS = Overrepresented_sequences,
AdC = Adapter_Content,
KmC = Kmer_Content)
#change table format
ret <- outp %>%
group_by(ID) %>%
gather(test, status, PBQ:KmC)
#plot how many samples failed the test
qc.fail <- ggplot()+
geom_bar(data = ret, aes(x = test, fill = status), stat = 'count', position = 'dodge')+
theme_bw()
#plot which sample failed which test
qc.samples <- ggplot()+
geom_tile(data = ret, aes(y = ID, x = test, fill = as.factor(status)))+
scale_fill_discrete(name = "Test\nstatus")+
xlab("FastQC test")+
ylab("Samples")+
theme_bw()+
theme(
axis.text.y = element_blank()
)
#plot pdf
pdf(opt$output_file)
print(qc.fail)
print(qc.samples)
dev.off()
#table with samples that faild a test
fail <- ret %>%
filter(status == "FAIL")
#get the ID number of the failed samples
fail.samp <- fail %>%
filter(!duplicated(ID)) %>%
select(ID)%>%
unlist() %>%
parse_number()%>%
unique() %>%
sort()
if(opt$print){
write(sprintf("The following sample failed at least one test: %s \n", fail.samp), stdout())
}
?read_delim
??read_delim
png(gsub(".pdf", ".png", opt$output_file))
print(qc.fail)
print(qc.samples)
dev.off()
lo_dates = '/Users/tobias/Desktop/last_occurrence_dates_literature.csv'
table = read.csv(lo_dates, sep = ';')
head(table)
str(table)
hist(table$last_occurrence_b1950_min,xlim = c(12000,0),breaks = 120)
tree = "(((((T_pyra1.0,T_pyra1.1),(T_pyra2.0,T_pyra2.1))((T_pyra3.0,T_pyra3.1),(T_pyra4.0,T_pyra4.1))))((((T_pella5.0,T_pella5.1),(T_pella6.0,T_pella6.1))(((T_pella8.0,T_pella8.1),(T_pella9.0,T_pella9.1)),(T_pella7.0,T_pella7.1)))))"
source("/Users/tobias/Documents/R_working_dir/scripts/read.newick.R")
library(ape)
tree = "(((((T_pyra1.0,T_pyra1.1),(T_pyra2.0,T_pyra2.1))((T_pyra3.0,T_pyra3.1),(T_pyra4.0,T_pyra4.1))))((((T_pella5.0,T_pella5.1),(T_pella6.0,T_pella6.1))(((T_pella8.0,T_pella8.1),(T_pella9.0,T_pella9.1)),(T_pella7.0,T_pella7.1)))))"
t1<-read.tree(text=tree)
plot(t1)
tree = "(((((T_pyra1.0,T_pyra1.1),(T_pyra2.0,T_pyra2.1))((T_pyra3.0,T_pyra3.1),(T_pyra4.0,T_pyra4.1))))((((T_pella5.0,T_pella5.1),(T_pella6.0,T_pella6.1))(((T_pella8.0,T_pella8.1),(T_pella9.0,T_pella9.1)),(T_pella7.0,T_pella7.1)))))"
t1<-read.tree(text=tree)
plot(t1)
t1
read.tree(text=tree)
tree <- "(((D #0.00196910000000000000, E #0.00249850000000000000) :0.00020020000000000000 #0.00185880000000000000, ((Y #0.00104190000000000000, Z #0.00261860000000000000) :0.00025410000000000000 #0.00159570000000000000, X #0.00278420000000000000) :0.00035330000000000000 #0.00233600000000000000) :0.00083790000000000000 #0.00157000000000000000, F #0.00157560000000000000) :0.00435610000000000000 #0.00852310000000000000;"
t1<-read.tree(text=tree)
t1
legend(nmincls-4,0,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
setwd("/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/analyses/species_da/empirical/xxx")
plot(c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
setwd("/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/analyses/species_da/empirical/allele_alignments/")
workdir<-getwd()
workdir
dir()
x<-read.table("species_da_results_xe-x.txt", sep="", header=TRUE)
x<-read.table("species_da_results_1e-5.txt", sep="", header=TRUE)
x
x$Florisuga <- NULL
y<-names(x)
y
renames <- matrix(c(
"pyra3", "T_pyra3",
"pella5", "T_pella5",
"pyra2", "T_pyra2",
"pella6", "T_pella6",
"pyra1", "T_pyra1",
"pella7", "T_pella7",
"pella8", "T_pella8",
"pella9", "T_pella9",
"pyra4", "T_pyra4"),
setwd("/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/analyses/species_da/empirical/consensus_contig_alignments/")
workdir<-getwd()
workdir
dir()
x<-read.table("species_da_results_1e-5.txt", sep="", header=TRUE)
x
x$Florisuga <- NULL
y<-names(x)
y
setwd("/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/analyses/species_da/empirical/consensus_contig_alignments/")
workdir<-getwd()
workdir
dir()
x<-read.table("species_da_results_1e-5.txt", sep="", header=TRUE)
x
x$Florisuga <- NULL
y<-names(x)
y
renames <- matrix(c(
"pyra3", "T_pyra3",
"pella5", "T_pella5",
"pyra2", "T_pyra2",
"pella6", "T_pella6",
"pyra1", "T_pyra1",
"pella7", "T_pella7",
"pella8", "T_pella8",
"pella9", "T_pella9",
"pyra4", "T_pyra4"),
nrow=9, ncol=2, byrow=TRUE)
renames
mincl.names<-colnames(x)[-(1:4)]
for (i in 1:length(mincl.names)) {
stopifnot(mincl.names[i] == renames[i,1])
}
mincl.names[1]
renames[1,1]
#make similarity matrix
displaynames <- renames[,2]
nmincls <- length(displaynames)
sim <- matrix(0, ncol=nmincls, nrow=nmincls, dimnames=list(displaynames, displaynames))
for (i in 1:nmincls) {
for (j in 1:nmincls) {
coli <- x[,mincl.names[i]]
colj <- x[,mincl.names[j]]
w <- coli == colj
sim[i,j] <- sum(x[w,"fraction"])
}
}
sim <- pmin(sim,1)
neworder <- c(5,3,1,9, 2,4,6,7,8)
dividers<-c(0,4,9)
plot.rectangle <- function(v1,v2,...)
{
polygon(c(v1[1],v2[1],v2[1],v1[1]), c(v1[2],v1[2],v2[2],v2[2]), ...)
}
plot.simmatrix <- function() {
par(mar= c(0,5,5,0)+.1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
axis(3, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
axis(2, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
for (i in 1:nmincls) {
for (j in 1:nmincls) {
d <- 1 - sim[neworder[i],neworder[j]]
plot.rectangle(c(i-1,j-1), c(i,j), col=rgb(d,d,d), border="white")
}
}
for (b in dividers) {
lines(x=c(-.5,nmincls), y=c(b,b))
lines(x=c(b,b), y=c(-.5,nmincls))
}
#legend(nmincls-4,0,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
}
print(sim[neworder,neworder], digits=2)
plot.simmatrix <- function() {
par(mar= c(0,5,5,0)+.1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
axis(3, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
axis(2, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
for (i in 1:nmincls) {
for (j in 1:nmincls) {
d <- 1 - sim[neworder[i],neworder[j]]
plot.rectangle(c(i-1,j-1), c(i,j), col=rgb(d,d,d), border="white")
}
}
for (b in dividers) {
lines(x=c(-.5,nmincls), y=c(b,b))
lines(x=c(b,b), y=c(-.5,nmincls))
}
legend(nmincls-4,0,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
}
plot.simmatrix()
plot.simmatrix <- function() {
par(mar= c(0,5,5,0)+.1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
axis(3, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
axis(2, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
for (i in 1:nmincls) {
for (j in 1:nmincls) {
d <- 1 - sim[neworder[i],neworder[j]]
plot.rectangle(c(i-1,j-1), c(i,j), col=rgb(d,d,d), border="white")
}
}
for (b in dividers) {
lines(x=c(-.5,nmincls), y=c(b,b))
lines(x=c(b,b), y=c(-.5,nmincls))
}
legend(nmincls-4,0,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=2, cex=2, box.lty = 1)
}
plot.simmatrix()
nmincls
plot.simmatrix <- function() {
par(mar= c(0,5,5,0)+.1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
axis(3, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
axis(2, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
for (i in 1:nmincls) {
for (j in 1:nmincls) {
d <- 1 - sim[neworder[i],neworder[j]]
plot.rectangle(c(i-1,j-1), c(i,j), col=rgb(d,d,d), border="white")
}
}
for (b in dividers) {
lines(x=c(-.5,nmincls), y=c(b,b))
lines(x=c(b,b), y=c(-.5,nmincls))
}
legend(4,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
}
plot.simmatrix()
legend(c(4,6),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot.simmatrix <- function() {
par(mar= c(0,5,5,0)+.1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
axis(3, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
axis(2, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
for (i in 1:nmincls) {
for (j in 1:nmincls) {
d <- 1 - sim[neworder[i],neworder[j]]
plot.rectangle(c(i-1,j-1), c(i,j), col=rgb(d,d,d), border="white")
}
}
for (b in dividers) {
lines(x=c(-.5,nmincls), y=c(b,b))
lines(x=c(b,b), y=c(-.5,nmincls))
}
#legend(c(4,6),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
}
plot.simmatrix()
legend(c(4,6),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 4)
?legend()
legend(1,ncols=4,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,ncol=4,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot.simmatrix()
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,4),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot.simmatrix()
legend(c(0,4),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(-1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,-1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(-1,-1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(-1,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot.simmatrix <- function() {
par(mar= c(0,5,5,0)+.1)
plot(0,10, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
axis(3, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
axis(2, at=(1:nmincls)-.5, displaynames[neworder], tick=FALSE, las=2, line=-1)
for (i in 1:nmincls) {
for (j in 1:nmincls) {
d <- 1 - sim[neworder[i],neworder[j]]
plot.rectangle(c(i-1,j-1), c(i,j), col=rgb(d,d,d), border="white")
}
}
for (b in dividers) {
lines(x=c(-.5,nmincls), y=c(b,b))
lines(x=c(b,b), y=c(-.5,nmincls))
}
#legend(c(4,6),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
}
plot.simmatrix()
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(0,100)
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(-10,100)
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(0,100,0,100)
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,100,0,100))
legend(0,0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(10,10,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,0,100,100))
legend(10,10,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(100,10,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(100,100,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(10,100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,10),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
legend(c(1,1),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(1,10),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(10,10),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(10,1),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
legend(c(10,1),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,nmincls), ylim=c(nmincls,0), axes=FALSE, ylab="", xlab="")
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,20), ylim=c(20,0), axes=FALSE, ylab="", xlab="")
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(0,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,200), ylim=c(200,0), axes=FALSE, ylab="", xlab="")
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,1,2,3,4,5,6,7,8,9), xlim=c(0,200), ylim=c(200,0), axes=FALSE, ylab="", xlab="")
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,1,2,3,4,5,6,7,8,9), xlim=c(0,200), ylim=c(200,0), axes=TRUE, ylab="", xlab="")
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,1,2,3,4,5,6,7,8,9), xlim=c(200,0), ylim=c(200,0), axes=TRUE, ylab="", xlab="")
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,1,2,3,4,5,6,7,8,9), xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(1,ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(1,1),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,200),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(200,100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,1,2,3,4,5,6,7,8,9), xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(200,100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,1000),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(0,1,2,3,4,5,6,7,8,9), xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(100,1000),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,100,200,200),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100,200,100,200),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(c(1,1), xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
plot(1,1, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
plot(1, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(100),ncol=5,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100),ncol=2,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(100),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,6),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,6),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,6),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,160),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50,),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(1, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(4,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50,50,4),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50,5,40),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50),c(5,40),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50),c(50,40),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(1, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(4,50),c(4,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,50),c(4,200),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,200),c(4,200),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,200),c(4,20),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(1, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(4,200),c(4,20),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,200),c(4,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(4,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(1, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(4,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(4,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
plot(NULL, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(0,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(10,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),box.col=grey,ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,bg=grey,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,bg=rgb(1,1,1),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,bty=o,bg=rgb(1,1,1),legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,bg=rgbgrey,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,bg=grey,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3, bg=grey ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=2, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=1, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="grey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = "black",bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = "grey",bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = grey,bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = c(rgb(1,1,1),bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
?legend()
dev.off()
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = c(rgb(1,1,1),bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = rgb(1,1,1),bg="lightgrey", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = rgb(1,1,1),bg="white", lwd=15, cex=1.5, box.lty = 1)
plot(NULL, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(0,200),c(0,50),ncol=3 ,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = rgb(1,1,1),bg="white", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3 ,pt.bg="grey",legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),border = rgb(1,1,1),bg="white", lwd=15, cex=1.5, box.lty = 1)
legend(c(0,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=1.5, box.lty = 1)
plot(NULL, xlim=c(0,200), ylim=c(0,200), axes=TRUE, ylab="", xlab="")
legend(c(0,200),c(0,50),ncol=3,legend = c("0%","25%","50%","75%","100%"),col=c(rgb(1,1,1),rgb(.75,.75,.75),rgb(.5,.5,.5),rgb(.25,.25,.25),rgb(0,0,0)),bg="white", lwd=15, cex=1.5, box.lty = 1)
