library(ape,lib.loc="/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/bin/r_packages/")
library(phyloch,lib.loc="/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/bin/r_packages/")
library(Hmisc,lib.loc="/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/bin/r_packages/")
library(phytools,lib.loc="/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/bin/r_packages/")
setwd("/Users/tobias/GitHub/topaza_uce/additional_analyses_2017/")
tree8 <- phyloch::read.beast(file = "analyses/treeannotator/rep8/simulated_iupac_consensus_alignments_stacey.tre")
tree8$tip.label <- Hmisc::capitalize(tree8$tip.label)
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree8<-phytools::rotateNodes(tree8,c(10,11,12,13,14,15,16,17))
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree8 <- phyloch::read.beast(file = "analyses/treeannotator/rep8/simulated_iupac_consensus_alignments_stacey.tre")
tree8$tip.label <- Hmisc::capitalize(tree8$tip.label)
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree8<-phytools::rotateNodes(tree8,c(10,11,12,13,15,16,17))
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree8 <- phyloch::read.beast(file = "analyses/treeannotator/rep8/simulated_iupac_consensus_alignments_stacey.tre")
tree8$tip.label <- Hmisc::capitalize(tree8$tip.label)
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree8<-phytools::rotateNodes(tree8,c(10,11,12,13))
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree8 <- phyloch::read.beast(file = "analyses/treeannotator/rep8/simulated_iupac_consensus_alignments_stacey.tre")
tree8$tip.label <- Hmisc::capitalize(tree8$tip.label)
tree8<-phytools::rotateNodes(tree8,c(10,11,12,13,14))
phytools::plotTree(tree8,pts=F,node.numbers=T)
tree7 <- phyloch::read.beast(file = "analyses/treeannotator/rep10/simulated_consensus_contig_alignments_stacey.tre")
tree8 <- phyloch::read.beast(file = "analyses/treeannotator/rep8/simulated_iupac_consensus_alignments_stacey.tre")
tree7$tip.label <- Hmisc::capitalize(tree7$tip.label)
tree8$tip.label <- Hmisc::capitalize(tree8$tip.label)
tree7<-phytools::rotateNodes(tree7,c(10,11,12,13,14,15,16,17))
tree8<-rotateConstr(tree8, tree7$tip.label)
phytools::plotTree(tree8,pts=F,node.numbers=T)
pink_cust = rgb(255,0,238,maxColorValue = 255)
color_allele <- c("black","black","blue","blue","blue","blue","blue","blue","blue","black","black","black","red","red","red","red","red","red","red","black","green","green","green","green","green","green","green",pink_cust,pink_cust,pink_cust,pink_cust,pink_cust,pink_cust,pink_cust)
color_consensus <- c("black","black","blue","blue","blue","black","red","red","red","black","green","green","green",pink_cust,pink_cust,pink_cust)
color_consensus_2 <- c("black","black","blue","blue","blue","black","red","red","red","black","black","green","green","green",pink_cust,pink_cust)
pdf("results/trees/empirical_allele_alignments_stacey.pdf")
tree1 <- phyloch::read.beast(file = "analyses/treeannotator/empirical_allele_alignments_stacey.tre")
tree1<-phytools::rotateNodes(tree1,c(29,30,33,32,31,35,34,20,21,22,23,24,26,25,27,28))
plot(tree1, edge.color = color_allele, edge.width = 2,x.lim = c(-0.00026, 0.00196))
add.scale.bar(length = 1e-04,lwd = 2)
node.support(tree1$posterior,cutoff=0,digits=2,cex=1,mode="numbers",pos = "above")
HPDbars(tree1, label = "height_95%_HPD",col = "skyblue",lwd=4)
dev.off()
plot(tree1, edge.color = color_allele, edge.width = 2,x.lim = c(-0.00026, 0.00196))
add.scale.bar(length = 1e-04,lwd = 2)
node.support(tree1$posterior,cutoff=0,digits=2,cex=1,mode="numbers",pos = "above")
HPDbars(tree1, label = "height_95%_HPD",col = "skyblue",lwd=4)
plot(tree8, edge.color = color_consensus, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
add.scale.bar(length = 1e-04,lwd = 2)
node.support(tree8$posterior,cutoff=0,digits=2,cex=1,mode="numbers",pos = "above")
HPDbars(tree8, label = "height_95%_HPD",col = "skyblue",lwd=4)
plot(tree8, edge.color = color_consensus2, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
plot(tree8, edge.color = color_consensus_2, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
color_consensus_3 <- c("black","black","blue","blue","blue","red","red","red","black","black","black","green","green","green",pink_cust,pink_cust)
plot(tree8, edge.color = color_consensus_2, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
plot(tree8, edge.color = color_consensus_3, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
color_consensus_3 <- c("black","black","blue","blue","blue","red","red","red","black","black","green","green","green",pink_cust,pink_cust,pink_cust)
plot(tree8, edge.color = color_consensus_3, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
add.scale.bar(length = 1e-04,lwd = 2)
node.support(tree8$posterior,cutoff=0,digits=2,cex=1,mode="numbers",pos = "above")
HPDbars(tree8, label = "height_95%_HPD",col = "skyblue",lwd=4)
pdf("results/trees/rep8/simulated_iupac_consensus_alignments_stacey.pdf")
plot(tree8, edge.color = color_consensus_3, edge.width = 2,x.lim=c(-7.5e-05, 0.00028))
add.scale.bar(length = 1e-04,lwd = 2)
node.support(tree8$posterior,cutoff=0,digits=2,cex=1,mode="numbers",pos = "above")
HPDbars(tree8, label = "height_95%_HPD",col = "skyblue",lwd=4)
dev.off()
